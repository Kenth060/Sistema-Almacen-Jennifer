<!DOCTYPE html>
<html lang="es" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Clientes Comercial Jennifer</title>
    <!-- FA pencil-->
    <link rel="shortcut icon" href="/resources/images/favicon.ico">
    <link rel="stylesheet" href="path/to/font-awesome/css/font-awesome.min.css"/>
    <!-- Bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous"/>
    <!-- Boxicons -->
    <link href="https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css"
      rel="stylesheet"/>
    <!--Estilo CSS-->
    <link rel="stylesheet" href="/resources/css/style.css" />

    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.6/css/dataTables.dataTables.css">
    <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/css/bootstrap.min.css">
	  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.22/css/dataTables.bootstrap5.min.css">
  </head>
  <body>
    <%- include('sidebar.ejs') %>

    <section class="home-section">
      <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <div class="Container">
          <div>
            <div id="panelRegistroCliente" class="panel-flotante panel-ancho" style="display: none">
              <div class="panel-content">
                <h3 class="fw-bold" style="color:#1e1952">Registrar un nuevo cliente</h3>

                <div style="max-height: 300px; overflow-y: auto">
                  <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12">
                    <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12">

                      <form action="/AddClient" method="post" class="needs-validation" novalidate>

                        <!-- Nombres -->
                        <div class="mt-3 mb-2">
                          <label for="Nombre" class="form-label fw-bold">Nombres del Cliente</label>
                          <input type="text" class="form-control" id="Tipo" name="Tipo_cl" placeholder="Tipo" value="Cliente"  hidden/>
                          <input type="text" class="form-control" id="Nombre" name="Nombre_cl" placeholder="Nombres del Cliente" required/>
                          <div class="invalid-feedback">Por favor ingrese los Nombres del Cliente</div>
                        </div>

                        <!-- Apellidos -->
                        <div class="mb-2">
                          <label for="Apellido" class="form-label fw-bold">Apellidos del cliente</label>
                          <input type="text" class="form-control" id="Apellido" name="Apellido_cl" placeholder="Apellidos del cliente" required/>
                          <div class="invalid-feedback">Por favor ingrese los Apellidos del Cliente</div>
                        </div>

                        <!-- Telefono -->
                        <div class="mb-2">
                          <label for="Telefono" class="form-label fw-bold">Teléfono  del cliente</label>
                          <input type="number" class="form-control" id="Telefono" name="Telefono_cl" placeholder="Teléfono del cliente"required/>
                          <div class="invalid-feedback">Por favor ingrese el numero de teléfono del Cliente</div>
                        </div>

                        <!-- Cedula -->
                        <div class="mb-2">
                          <label for="Cedula" class="form-label  fw-bold">Cédula  del cliente</label>
                          <input type="text" class="form-control" id="Cedula" name="Cedula_cl" placeholder="Cédula del cliente" required/>
                          <div class="invalid-feedback">Por favor ingrese el número de cédula del cliente</div>
                        </div>

                        <!-- Direccion -->
                        <div class="mb-1 position-relative">
                          <h5 class="my-3 fw-bold">Dirección del Cliente</h5>
                          <label for="Distrito_cl" class="form-label fw-bold">Seleccione el Distrito</label>
                          <select id="Distrito" name="Distrito_cl" class="form-select mb-2 position-relative" aria-label="Distrito" required>
                            <option selected disabled value="">Seleccione el  Distrito... </option>
                            <option value="I">Distrito I</option>
                            <option value="II">Distrito II</option>
                            <option value="III">Distrito III</option>
                            <option value="IV">Distrito IV</option>
                            <option value="V">Distrito V</option>
                            <option value="VI">Distrito VI</option>
                            <option value="VII">Distrito VII</option>
                          </select>
                          <div class="invalid-feedback">Por favor ingrese el Distrito</div>
                        </div>

                        <!-- Zona de Residencia -->
                        <div class="mb-2">
                          <label for="Residencia" class="form-label fw-bold">Zona de Residencia</label>
                          <input type="text" class="form-control" id="Residencia" name="Residencia_cl" placeholder="Zona de Residencia" required />
                          <div class="invalid-feedback">Por favor ingrese la Zona de Residencia</div>
                        </div>

                        <!-- P. Referencia -->
                        <div class="mb-2">
                          <label for="PuntoReferencia" class="form-label  fw-bold">Punto de Referencia</label>
                          <input type="text" class="form-control" id="PuntoReferencia" name="PuntoReferencia_cl" placeholder="Punto de Referencia" required/>
                          <div class="invalid-feedback">Por favor ingrese el Punto de Referencia</div>
                        </div>

                        <!-- Distancia -->
                        <div class="mb-2">
                          <label for="Distancia" class="form-label fw-bold">Distancia</label>
                          <input
                            type="text"
                            class="form-control"
                            id="Distancia"
                            name="Distancia_cl"
                            placeholder="Distancia"
                          />
                        </div>

                        <!-- Casa -->
                        <div class="mb-2">
                          <label for="Casa" class="form-label fw-bold"
                            >Información de la casa</label
                          >
                          <input
                            type="text"
                            class="form-control"
                            id="Casa"
                            name="Casa_cl"
                            placeholder="N. Casa y/o color"
                            required
                          />
                          <div class="invalid-feedback">Por favor ingrese la información de la casa</div>
                        </div>

                        <div class="d-grid gap-2">
                          <button
                            type="submit"
                            class="btn btn-success"
                            title="Guardar"
                          >
                            Guardar
                          </button>
                          <button
                            class="btn btn-secondary"
                            title="Limpiar Campos"
                            onclick="Limpiar()"
                          >
                            Limpiar Campos
                          </button>
                        </div>
                      </form>
                    </div>
                  </div>
                  <div class="py-3">
                    <button
                    type="button"
                    class="btn btn-danger "
                    onclick="cerrarPanelRegistroCliente()">
                    Cerrar
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="Container px-3 py-1 contenedorventas">
        <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12"></div>
        <h4>Listado y Registro de Clientes</h4>
      </div>

      <div class="Container px-2">
        <div class="row">
          <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12">
            <div class="px-3 py-2">
              <h4 style="display: flex; justify-content: space-between">
                Listado de clientes
                <button
                  type="button"
                  class="btn btn-success"
                  title="Historial"
                  onclick="mostrarPanelRegistroCliente()"
                >
                <i class="fa-solid fa-user-plus mx-1"></i> Registrar un nuevo cliente
                </button>
              </h4>
            </div>
            <!-- <nav class="navbar bg-body-tertiary">
              <div class="container-fluid">
                <a class="navbar-brand">Buscar cliente</a>
                <form
                  action="/SearchCliente"
                  method="post"
                  class="d-flex"
                  role="search"
                >
                  <input
                    id="search"
                    name="nombreSearch"
                    class="form-control me-2"
                    type="search"
                    placeholder="Buscar..."
                    aria-label="Search"
                    onkeyup="SearchCliente()"
                  />
                  <button class="btn btn-outline-success" type="submit">
                    Buscar
                  </button>
                </form>
              </div>
            </nav> -->
            <table class="table primary ml-1 hover" id="TableClients">
              <thead>
                <tr>
                  <th class="centrado">Nombre completo</th>
                  <th class="centrado">Cédula</th>
                  <th class="centrado">Teléfono</th>
                  <th class="centrado">Dirección</th>
                  <th class="centrado">Crédito Disponible</th>
                  <th class="centrado">Estado Cliente</th>
                  <th class="centrado">Acciones</th>
                </tr>
              </thead>
              <tbody>
                <% clientes.forEach((client) => { %>
                <tr>
                  <td class="centrado"><%= client.Nombre %></td>
                  <td class="centrado"><%= client.Cedula %></td>
                  <td class="centrado"><%= client.Telefono %></td>
                  <td class="centrado"><%= client.Dirección %></td>
                  <td class="centrado">C$ <%= client.Credito_Disponible %></td>

                  <% if (client.Estado_Cliente == 'Activo') { %>
                    <td class="text-success fw-bold"><%= client.Estado_Cliente %></td>
                  <% } else if (client.Estado_Cliente == 'Inactivo') { %>
                    <td class="text-danger fw-bold"><%= client.Estado_Cliente %></td>
                  <% } else{ %> 
                    <td><%= client.Estado_Cliente %></td>
                  <% } %> 
                  <td>
                    <!-- Botones de acciones -->
                    <a
                      href="/EditClient/<%= client.Id_Cliente %>"
                      class="btn btn-success mb-1"
                      title="Actualizar"
                      ><svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        fill="currentColor"
                        class="bi bi-pencil-square"
                        viewBox="0 0 16 16"
                      >
                        <path
                          d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"
                        />
                        <path
                          fill-rule="evenodd"
                          d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"
                        /></svg
                    ></a>

                   <!--  <a
                      href="#"
                      class="btn btn-danger"
                      title="Eliminar"
                      onclick="confirmDelete('<%= client.Id_Cliente %>')"
                      ><svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        fill="currentColor"
                        class="bi bi-trash"
                        viewBox="0 0 16 16"
                      >
                        <path
                          d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"
                        />
                        <path
                          d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"
                        /></svg
                    ></a> -->

                    <button
                      type="button"
                      class="btn btn-primary RecordCrediticio"
                      title="RecordCrediticio"
                      onclick="mostrarPanelRecordCrediticio('<%= client.Id_Cliente %>','<%= client.Nombre %>')"
                    >
                    <i class="fa-solid fa-address-card"></i>
                    </button>
                  </td>
                </tr>
                <% }) %>
              </tbody>
            </table>
          </div>
        </div>
        <div
          id="panelRecordCrediticio"
          class="panel-flotante"
          style="display: none"
        >
          <div class="panel-content">
            <h4>Record Crediticio</h4>
            <nav class="navbar bg-body-tertiary"></nav>
            <div style="max-height: 200px; overflow-y: auto">
              <div>
                <table class="table primary px-3" id="TablaRecordCrediticio">
                  <thead>
                    <tr>
                      <th class="centrado">Cliente</th>
                      <th class="centrado">Fecha de la Venta</th>
                      <th class="centrado">Total de la Venta</th>
                      <th class="centrado">Estado</th>
                    </tr>
                  </thead>
                  <tbody>
                  </tbody>
                </table>
              </div>
            </div>
            <button
              type="button"
              class="btn btn-danger"
              onclick="cerrarPanelRecordCrediticio()"
            >
              Cerrar
            </button>
          </div>
        </div>
      </div>
    </section>

    <script src="/resources/js/ScriptClient.js"></script>
    <script src="/resources/js/script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous" ></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script type="text/javascript" language="javascript" src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script type="text/javascript" language="javascript" src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" language="javascript" src="https://cdn.datatables.net/1.10.22/js/dataTables.bootstrap5.min.js"></script>      

    <!-- codigo js para las validaciones-->
    <script>
      // Example starter JavaScript for disabling form submissions if there are invalid fields
      (() => {
        "use strict";

        // Fetch all the forms we want to apply custom Bootstrap validation styles to
        const forms = document.querySelectorAll(".needs-validation");

        // Loop over them and prevent submission
        Array.from(forms).forEach((form) => {
          form.addEventListener(
            "submit",
            (event) => {
              if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
              }

              form.classList.add("was-validated");
            },
            false
          );
        });
      })();
    </script>

    <% if (typeof alert != "undefined") { %>
    <script>
      Swal.fire({
        title: "<%= alertTitle %>",
        text: "<%= alertMessage %>",
        icon: "<%= alertIcon %>",
        showConfirmButton: true,
        timer: false,
      }).then(() => {
        window.location = "/<%= ruta %>";
      });
    </script>
    <% } %>

    <script>
      $(document).ready(function(){
          $('#TableClients').DataTable({
            info: false,
            ordering: false,
            lengthMenu: [5,10,15,20,25,50],
            "oLanguage": {
              "sSearch": "Buscar a un Cliente:",
              "sZeroRecords": "No se encontraron resultados",
              "sLengthMenu": "Mostrar _MENU_ Clientes",
              "sZeroRecords": "No se encontraron resultados",
              "sLoadingRecords": "Cargando...",
              "oPaginate": {
                  "sFirst": "Primero",
                  "sLast": "Último",
                  "sNext": "Siguiente",
                  "sPrevious": "Anterior"}
              }
          })
          ;
      });
    </script>
  </body>
</html>
